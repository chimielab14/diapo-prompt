<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhD Defense Assistant - Fixed Version</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <style>
        .user-input {
            font-family: 'Tajawal', sans-serif;
            color: #4f46e5;  /* Indigo-600 */
            font-weight: 700;
            background-color: #eef2ff;  /* Indigo-50 */
            padding: 0.1em 0.3em;
            border-radius: 0.25em;
        }

        .prompt-text {
            white-space: pre-wrap;
            font-family: 'Tajawal', sans-serif;
            line-height: 1.6;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .status-message {
            transition: all 0.3s ease;
        }
        
        .tool-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .tab-button.active {
            background-color: #4f46e5;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">

    <!-- Home Page -->
    <div id="homePage" class="page active">
        <div class="gradient-bg min-h-screen flex items-center justify-center p-4">
            <div class="max-w-4xl mx-auto text-center text-white fade-in">
                <h1 class="text-5xl font-bold mb-4">
                    <i class="fas fa-graduation-cap mr-4"></i>
                    PhD Defense Assistant
                </h1>
                <p class="text-xl mb-8 opacity-90">Generate professional defense speeches and PowerPoint presentations</p>
                <p class="text-lg mb-12 opacity-80">Designed and developed by Mr. May Abdelghani</p>
                
                <div class="grid md:grid-cols-2 gap-8 mt-12">
                    <!-- Speech Generator Card -->
                    <div class="tool-card bg-white rounded-xl p-8 text-gray-800 cursor-pointer" onclick="showToolPage('speech')">
                        <div class="text-6xl text-blue-500 mb-6">
                            <i class="fas fa-microphone"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4">Speech Generator</h3>
                        <p class="text-gray-600 mb-6">Create comprehensive oral defense speeches to accompany your PowerPoint presentation with clear sections, smooth transitions, and academic rigor.</p>
                        <div class="bg-blue-100 text-blue-800 px-4 py-2 rounded-lg inline-block">
                            <i class="fas fa-arrow-right mr-2"></i>
                            Get Started
                        </div>
                    </div>
                    
                    <!-- Presentation Generator Card -->
                    <div class="tool-card bg-white rounded-xl p-8 text-gray-800 cursor-pointer" onclick="showToolPage('presentation')">
                        <div class="text-6xl text-green-500 mb-6">
                            <i class="fas fa-presentation"></i>
                        </div>
                        <h3 class="text-2xl font-bold mb-4">Presentation Generator</h3>
                        <p class="text-gray-600 mb-6">Generate PowerPoint presentation prompts based on your completed defense speech with instructions for building slides that perfectly match your oral presentation.</p>
                        <div class="bg-green-100 text-green-800 px-4 py-2 rounded-lg inline-block">
                            <i class="fas fa-arrow-right mr-2"></i>
                            Get Started
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Speech Generator Page -->
    <div id="speechPage" class="page" style="display: none;">
        <div class="min-h-screen bg-gray-50">
            <!-- Header -->
            <div class="bg-white shadow-sm border-b">
                <div class="max-w-6xl mx-auto px-4 py-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <button onclick="showHomePage()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg mr-4 transition-colors">
                                <i class="fas fa-home mr-2"></i>HOME
                            </button>
                            <h1 class="text-2xl font-bold text-gray-800">
                                <i class="fas fa-microphone mr-2 text-blue-500"></i>
                                Speech Generator
                            </h1>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Language Tabs -->
            <div class="max-w-6xl mx-auto px-4 py-6">
                <div class="bg-white rounded-lg shadow-sm">
                    <div class="border-b">
                        <nav class="flex">
                            <button class="tab-button px-6 py-3 font-medium text-gray-600 hover:bg-gray-50 border-b-2 border-transparent active" onclick="showSpeechTab('english')">
                                <i class="fas fa-flag-usa mr-2"></i>English
                            </button>
                            <button class="tab-button px-6 py-3 font-medium text-gray-600 hover:bg-gray-50 border-b-2 border-transparent" onclick="showSpeechTab('french')">
                                <i class="fas fa-flag mr-2"></i>Fran√ßais
                            </button>
                        </nav>
                    </div>
                    
                    <!-- English Speech Tab -->
                    <div id="speechEnglishTab" class="tab-content active p-6">
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold mb-4">About the Speech Generator</h3>
                            <p class="text-gray-600 mb-4">Create a comprehensive oral defense speech to accompany your PowerPoint presentation. This tool helps you structure your defense with clear sections, smooth transitions, and academic rigor.</p>
                            
                            <h4 class="font-semibold mb-2">How to Use:</h4>
                            <ol class="list-decimal list-inside text-gray-600 space-y-1">
                                <li>Enter your thesis file name</li>
                                <li>Add any specific notes or instructions</li>
                                <li>Click "Generate Speech" to create your customized defense script</li>
                                <li>Copy the result to use with your presentation</li>
                            </ol>
                        </div>
                        
                        <div class="space-y-6">
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">Upload Thesis File:</label>
                                <div class="flex items-center space-x-4">
                                    <label class="cursor-pointer bg-white border border-gray-300 rounded-md px-4 py-2 hover:bg-gray-50 transition-colors">
                                        <i class="fas fa-upload mr-2"></i>Choose File
                                        <input type="file" id="speechThesisFileEn" class="hidden" accept=".pdf,.doc,.docx">
                                    </label>
                                    <span id="thesisFileNameEn" class="text-sm text-gray-500 truncate max-w-xs">No file selected</span>
                                </div>
                            </div>

                            <button onclick="generateSpeechPrompt('english')" class="w-full sm:w-auto bg-blue-500 hover:bg-blue-600 text-white px-4 sm:px-6 py-3 rounded-lg font-medium transition-colors">
                                <i class="fas fa-magic mr-2"></i>Generate Speech
                            </button>
                            
                            <div id="speechStatusEn" class="status-message"></div>
                            
                            <div id="speechResultEn" style="display: none;" class="bg-gray-50 border rounded-lg p-4">
                                <div class="flex items-center justify-between mb-3">
                                    <h4 class="font-semibold">Generated Defense Speech</h4>
                                    <div class="space-x-2">
                                        <button onclick="copySpeechPrompt('english')" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded text-sm transition-colors">
                                            <i class="fas fa-copy mr-1"></i>Copy
                                        </button>
                                        <button onclick="showHomePage()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm transition-colors">
                                            <i class="fas fa-home mr-1"></i>Home
                                        </button>
                                        <button onclick="resetSpeechPrompt('english')" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm transition-colors">
                                            <i class="fas fa-trash mr-1"></i>Reset
                                        </button>
                                    </div>
                                </div>
                                <div id="speechOutputEn" class="w-full h-64 px-3 py-2 border border-gray-300 rounded-md bg-white overflow-auto"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- French Speech Tab -->
                    <div id="speechFrenchTab" class="tab-content p-6">
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold mb-4">√Ä propos du G√©n√©rateur de Discours</h3>
                            <p class="text-gray-600 mb-4">Cr√©ez un discours de soutenance orale complet pour accompagner votre pr√©sentation PowerPoint. Cet outil vous aide √† structurer votre d√©fense avec des sections claires, des transitions fluides et une rigueur acad√©mique.</p>
                            
                            <h4 class="font-semibold mb-2">Comment utiliser :</h4>
                            <ol class="list-decimal list-inside text-gray-600 space-y-1">
                                <li>Entrez le nom du fichier de votre th√®se</li>
                                <li>Ajoutez des notes ou instructions sp√©cifiques</li>
                                <li>Cliquez sur "G√©n√©rer le Discours" pour cr√©er votre script de d√©fense personnalis√©</li>
                                <li>Copiez le r√©sultat pour l'utiliser avec votre pr√©sentation</li>
                            </ol>
                        </div>
                        
                        <div class="space-y-6">
                            <div class="space-y-2">
                                <label class="block text-sm font-medium text-gray-700">T√©l√©verser le Fichier de Th√®se :</label>
                                <div class="flex items-center space-x-4">
                                    <label class="cursor-pointer bg-white border border-gray-300 rounded-md px-4 py-2 hover:bg-gray-50 transition-colors">
                                        <i class="fas fa-upload mr-2"></i>Choisir un Fichier
                                        <input type="file" id="speechThesisFileFr" class="hidden" accept=".pdf,.doc,.docx">
                                    </label>
                                    <span id="thesisFileNameFr" class="text-sm text-gray-500 truncate max-w-xs">Aucun fichier s√©lectionn√©</span>
                                </div>
                            </div>

                            <button onclick="generateSpeechPrompt('french')" class="w-full sm:w-auto bg-blue-500 hover:bg-blue-600 text-white px-4 sm:px-6 py-3 rounded-lg font-medium transition-colors">
                                <i class="fas fa-magic mr-2"></i>G√©n√©rer le Discours
                            </button>
                            
                            <div id="speechStatusFr" class="status-message"></div>
                            
                            <div id="speechResultFr" style="display: none;" class="bg-gray-50 border rounded-lg p-4">
                                <div class="flex items-center justify-between mb-3">
                                    <h4 class="font-semibold">Discours de D√©fense G√©n√©r√©</h4>
                                    <div class="space-x-2">
                                        <button onclick="copySpeechPrompt('french')" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded text-sm transition-colors">
                                            <i class="fas fa-copy mr-1"></i>Copier
                                        </button>
                                        <button onclick="showHomePage()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm transition-colors">
                                            <i class="fas fa-home mr-1"></i>Accueil
                                        </button>
                                        <button onclick="resetSpeechPrompt('french')" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm transition-colors">
                                            <i class="fas fa-trash mr-1"></i>R√©initialiser
                                        </button>
                                    </div>
                                </div>
                                <div id="speechOutputFr" class="w-full h-64 px-3 py-2 border border-gray-300 rounded-md bg-white overflow-auto"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Presentation Generator Page -->
    <div id="presentationPage" class="page" style="display: none;">
        <div class="min-h-screen bg-gray-50">
            <!-- Header -->
            <div class="bg-white shadow-sm border-b">
                <div class="max-w-6xl mx-auto px-4 py-4">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center">
                            <button onclick="showHomePage()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg mr-4 transition-colors">
                                <i class="fas fa-home mr-2"></i>HOME
                            </button>
                            <h1 class="text-2xl font-bold text-gray-800">
                                <i class="fas fa-presentation mr-2 text-green-500"></i>
                                Presentation Generator
                            </h1>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Language Tabs -->
            <div class="max-w-6xl mx-auto px-4 py-6">
                <div class="bg-white rounded-lg shadow-sm">
                    <div class="border-b">
                        <nav class="flex">
                            <button class="tab-button px-6 py-3 font-medium text-gray-600 hover:bg-gray-50 border-b-2 border-transparent active" onclick="showPresentationTab('english')">
                                <i class="fas fa-flag-usa mr-2"></i>English
                            </button>
                            <button class="tab-button px-6 py-3 font-medium text-gray-600 hover:bg-gray-50 border-b-2 border-transparent" onclick="showPresentationTab('french')">
                                <i class="fas fa-flag mr-2"></i>Fran√ßais
                            </button>
                        </nav>
                    </div>
                    
                    <!-- English Presentation Tab -->
                    <div id="presentationEnglishTab" class="tab-content active p-6">
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold mb-4">About the Presentation Generator</h3>
                            <p class="text-gray-600 mb-4">Generate a PowerPoint presentation prompt based on your completed defense speech. This tool creates instructions for building slides that perfectly match your oral presentation.</p>
                            
                            <h4 class="font-semibold mb-2">How to Use:</h4>
                            <ol class="list-decimal list-inside text-gray-600 space-y-1">
                                <li>Upload your completed defense speech file</li>
                                <li>Add any specific notes for the PowerPoint design</li>
                                <li>Click "Generate PowerPoint Prompt" to create the instructions</li>
                                <li>Copy the result to use with your AI assistant</li>
                            </ol>
                        </div>
                        
                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Speech File:</label>
                                <input type="file" id="presentationFileEn" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" accept=".txt,.doc,.docx,.pdf">
                                <div class="text-sm text-gray-500 mt-1">
                                    <span id="presentationFileStatusEn">No file selected</span>
                                </div>
                            </div>
                            

                            <button onclick="generatePresentationPrompt('english')" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                                <i class="fas fa-magic mr-2"></i>Generate PowerPoint Prompt
                            </button>
                            
                            <div id="presentationStatusEn" class="status-message"></div>
                            
                            <div id="presentationResultEn" style="display: none;" class="bg-gray-50 border rounded-lg p-4">
                                <div class="flex items-center justify-between mb-3">
                                    <h4 class="font-semibold">Generated PowerPoint Prompt</h4>
                                    <div class="space-x-2">
                                        <button onclick="copyPresentationPrompt('english')" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded text-sm transition-colors">
                                            <i class="fas fa-copy mr-1"></i>Copy
                                        </button>
                                        <button onclick="showHomePage()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm transition-colors">
                                            <i class="fas fa-home mr-1"></i>Home
                                        </button>
                                        <button onclick="resetPresentationPrompt('english')" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm transition-colors">
                                            <i class="fas fa-trash mr-1"></i>Reset
                                        </button>
                                    </div>
                                </div>
                                <div id="presentationOutputEn" class="w-full h-64 px-3 py-2 border border-gray-300 rounded-md bg-white overflow-auto"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- French Presentation Tab -->
                    <div id="presentationFrenchTab" class="tab-content p-6">
                        <div class="mb-8">
                            <h3 class="text-lg font-semibold mb-4">√Ä propos du G√©n√©rateur de Pr√©sentation</h3>
                            <p class="text-gray-600 mb-4">G√©n√©rez une invite de pr√©sentation PowerPoint bas√©e sur votre discours de d√©fense termin√©. Cet outil cr√©e des instructions pour construire des diapositives qui correspondent parfaitement √† votre pr√©sentation orale.</p>
                            
                            <h4 class="font-semibold mb-2">Comment utiliser :</h4>
                            <ol class="list-decimal list-inside text-gray-600 space-y-1">
                                <li>T√©l√©chargez votre fichier de discours de d√©fense termin√©</li>
                                <li>Ajoutez des notes sp√©cifiques pour la conception PowerPoint</li>
                                <li>Cliquez sur "G√©n√©rer l'Invite PowerPoint" pour cr√©er les instructions</li>
                                <li>Copiez le r√©sultat pour l'utiliser avec votre assistant IA</li>
                            </ol>
                        </div>
                        
                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Fichier du Discours:</label>
                                <input type="file" id="presentationFileFr" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500" accept=".txt,.doc,.docx,.pdf">
                                <div class="text-sm text-gray-500 mt-1">
                                    <span id="presentationFileStatusFr">Aucun fichier s√©lectionn√©</span>
                                </div>
                            </div>
                            

                            <button onclick="generatePresentationPrompt('french')" class="bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-medium transition-colors">
                                <i class="fas fa-magic mr-2"></i>G√©n√©rer l'Invite PowerPoint
                            </button>
                            
                            <div id="presentationStatusFr" class="status-message"></div>
                            
                            <div id="presentationResultFr" style="display: none;" class="bg-gray-50 border rounded-lg p-4">
                                <div class="flex items-center justify-between mb-3">
                                    <h4 class="font-semibold">Invite PowerPoint G√©n√©r√©e</h4>
                                    <div class="space-x-2">
                                        <button onclick="copyPresentationPrompt('french')" class="bg-gray-500 hover:bg-gray-600 text-white px-3 py-1 rounded text-sm transition-colors">
                                            <i class="fas fa-copy mr-1"></i>Copier
                                        </button>
                                        <button onclick="showHomePage()" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-1 rounded text-sm transition-colors">
                                            <i class="fas fa-home mr-1"></i>Accueil
                                        </button>
                                        <button onclick="resetPresentationPrompt('french')" class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm transition-colors">
                                            <i class="fas fa-trash mr-1"></i>R√©initialiser
                                        </button>
                                    </div>
                                </div>
                                <div id="presentationOutputFr" class="w-full h-64 px-3 py-2 border border-gray-300 rounded-md bg-white overflow-auto"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Speech Templates
        const speechTemplates = {
            english: `Act like an expert in scientific communication and academic speech writing, specializing in preparing impactful, clear, and persuasive oral defenses for PhD dissertations. You are known for crafting compelling and structured presentations tailored to academic juries, turning complex research into engaging and understandable narratives.

Objective: The attached file [{{FILENAME}}] is my dissertation. Based on its content, your task is to prepare a comprehensive oral defense speech that will accompany each PowerPoint slide in the presentation. Proceed as follows:

For each chapter or major section of the dissertation:
1. Analyze the content and extract the essential ideas.
2. Divide it into a logical series of slides, following the typical structure of a PhD defense.

For each slide, provide:

üìå Slide content: a bullet-point list summarizing the key concepts, results, essential data, and partial conclusions.
üó£Ô∏è Associated speech: a fluent, academic, and persuasive script that expands on the bullet points and clearly communicates the scientific reasoning.
üîÅ Slide transition: a smooth, logically connected sentence to bridge to the next slide or section.

At the end of each chapter or major section:
- Prompt me to confirm whether I want to proceed to the next part or make revisions before continuing.

Expected output format:
--------------------------------------
Slide X: [Slide title]
üìå Slide content:
‚Ä¢ Key idea 1
‚Ä¢ Key idea 2
‚Ä¢ Key idea 3
‚Ä¢ Partial conclusion
üó£Ô∏è Associated speech:
A fluent and well-structured academic text that expands on each point with clarity, scientific rigor, and rhetorical engagement.
üîÅ Transition:
A transition sentence introducing the next slide or topic.

Please work with rigor, clarity, and attention to detail. Maintain an academic tone while ensuring accessibility. Be methodical and highly precise at each step.`,

    french: `Agis comme un expert en communication scientifique et en r√©daction de discours acad√©miques, sp√©cialis√© dans la pr√©paration de soutenances de th√®se percutantes, claires et convaincantes. Tu es reconnu pour concevoir des pr√©sentations structur√©es et engageantes, adapt√©es aux jurys universitaires, et pour transformer des recherches complexes en r√©cits accessibles et captivants.

Objectif : Le fichier joint [{{FILENAME}}] est ma th√®se de doctorat. √Ä partir de son contenu, ta mission est de pr√©parer un discours complet de soutenance qui accompagnera chaque diapositive du PowerPoint. Proc√®de comme suit :

Pour chaque chapitre ou grande section de la th√®se :
1. Analyse le contenu et identifie les id√©es essentielles.
2. D√©coupe-le en une s√©rie logique de diapositives, en suivant la structure classique d'une soutenance de doctorat.

Pour chaque diapositive, fournis :

üìå Contenu de la diapositive : une liste √† puces r√©sumant les id√©es cl√©s, les r√©sultats exp√©rimentaux, les donn√©es essentielles et les conclusions partielles.
üó£Ô∏è Discours associ√© : un texte fluide, acad√©mique et persuasif, d√©veloppant les points de la diapositive tout en expliquant le raisonnement scientifique avec clart√© et assurance.
üîÅ Transition : une phrase de transition pour assurer une continuit√© logique fluide vers la diapositive ou la section suivante.

√Ä la fin de chaque chapitre ou section importante :
- Demande-moi si je souhaite passer √† la suite ou apporter des modifications avant de continuer.

Format de sortie attendu :
--------------------------------------
Diapositive X : [Titre de la diapositive]
üìå Contenu de la diapositive :
‚Ä¢ Id√©e cl√© 1
‚Ä¢ Id√©e cl√© 2
‚Ä¢ Id√©e cl√© 3
‚Ä¢ Conclusion partielle
üó£Ô∏è Discours associ√© :
Un texte acad√©mique fluide et structur√©, d√©veloppant chaque point avec rigueur scientifique, clart√© et sens p√©dagogique.
üîÅ Transition :
Une phrase de transition introduisant la diapositive ou le th√®me suivant.

Travaille avec rigueur, pr√©cision et souci du d√©tail. Maintiens un ton acad√©mique tout en assurant une accessibilit√© maximale. Sois m√©thodique √† chaque √©tape.`
        };

        // Presentation Templates
        const presentationTemplates = {
            english: `Carefully read the attached file titled: {{FILENAME}}.

{{NOTES}}

This document contains the full speech for a PhD thesis defense, including:

1. The content that should appear on each slide (titles, bullet points, figures, diagrams, etc.),
2. As well as the spoken script that accompanies each slide, intended for oral delivery to the jury.

Your task is to create a complete PowerPoint presentation (.pptx format) based on the information in this file.

For each slide:
1. Include only the visual and textual content meant to be displayed on screen (titles, bullet points, tables, spectra, reaction schemes, figure placeholders, etc.).
2. Ignore the spoken script, unless it contains technical or factual details (e.g., specific data or figure descriptions) that are not explicitly listed in the "slide content" sections.
3. If a figure or diagram is mentioned (e.g., "Figure 14: UV-Vis spectrum"), insert a placeholder or a labeled space in the slide so that it can be added later.
4. Keep a clear and professional layout, with one title per slide, clean bullet points, and neutral color tones suitable for academic presentations.
5. The presentation should include all slides listed in the document, from the title page to the acknowledgements, in the same order.

Once complete, export the result as a PowerPoint (.pptx) file.`,

            french: `Lisez attentivement le fichier joint intitul√©: {{FILENAME}}

{{NOTES}}

Ce document contient le discours complet de la soutenance de th√®se de doctorat, y compris :

1. Le contenu qui doit appara√Ætre sur chaque diapositive (titres, puces, figures, sch√©mas, etc.),
2. Ainsi que le script oral qui accompagne chaque diapositive, destin√© √† la pr√©sentation devant le jury.

Votre t√¢che consiste √† cr√©er une pr√©sentation PowerPoint compl√®te (au format .pptx) √† partir des informations contenues dans ce fichier.

Pour chaque diapositive :
1. Incluez uniquement le contenu visuel et textuel destin√© √† √™tre affich√© √† l'√©cran (titres, points cl√©s, tableaux, spectres, sch√©mas r√©actionnels, espaces r√©serv√©s aux figures, etc.).
2. Ignorez le script oral, sauf s'il contient des d√©tails techniques ou factuels (par exemple : donn√©es sp√©cifiques ou descriptions de figures) qui ne sont pas explicitement list√©s dans les sections ¬´ contenu de la diapositive ¬ª.
3. Si une figure ou un sch√©ma est mentionn√© (par exemple : ¬´ Figure 14 : spectre UV-Vis ¬ª), ins√©rez un espace r√©serv√© ou un emplacement l√©gend√© dans la diapositive afin qu'il puisse √™tre ajout√© ult√©rieurement.
4. Gardez une mise en page claire et professionnelle, avec un seul titre par diapositive, des puces bien structur√©es et des tons neutres adapt√©s √† une pr√©sentation acad√©mique.
5. La pr√©sentation doit inclure toutes les diapositives list√©es dans le document, de la page de titre jusqu'aux remerciements, dans le m√™me ordre.

Une fois la pr√©sentation termin√©e, exportez le r√©sultat au format PowerPoint (.pptx)..`
        };

        // Navigation Functions
        function showHomePage() {
            document.querySelectorAll('.page').forEach(page => page.style.display = 'none');
            document.getElementById('homePage').style.display = 'block';
        }

        function showToolPage(tool) {
            document.querySelectorAll('.page').forEach(page => page.style.display = 'none');
            if (tool === 'speech') {
                document.getElementById('speechPage').style.display = 'block';
            } else if (tool === 'presentation') {
                document.getElementById('presentationPage').style.display = 'block';
            }
        }

        function showSpeechTab(language) {
            // Update tab buttons
            document.querySelectorAll('#speechPage .tab-button').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Show/hide tab content
            document.querySelectorAll('#speechPage .tab-content').forEach(content => content.classList.remove('active'));
            if (language === 'english') {
                document.getElementById('speechEnglishTab').classList.add('active');
            } else {
                document.getElementById('speechFrenchTab').classList.add('active');
            }
        }

        function showPresentationTab(language) {
            // Update tab buttons
            document.querySelectorAll('#presentationPage .tab-button').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Show/hide tab content
            document.querySelectorAll('#presentationPage .tab-content').forEach(content => content.classList.remove('active'));
            if (language === 'english') {
                document.getElementById('presentationEnglishTab').classList.add('active');
            } else {
                document.getElementById('presentationFrenchTab').classList.add('active');
            }
        }

        // Utility Functions
        function updateCharCount(textareaId, countId) {
            const textarea = document.getElementById(textareaId);
            const counter = document.getElementById(countId);
            counter.textContent = textarea.value.length;
        }

        function showStatus(statusId, message, type = 'info') {
            const statusElement = document.getElementById(statusId);
            const colors = {
                success: 'text-green-600 bg-green-100 border-green-200',
                error: 'text-red-600 bg-red-100 border-red-200',
                info: 'text-blue-600 bg-blue-100 border-blue-200'
            };
            
            statusElement.className = `status-message p-3 rounded-lg border ${colors[type]}`;
            statusElement.textContent = message;
            statusElement.style.display = 'block';
            
            setTimeout(() => {
                statusElement.style.display = 'none';
            }, 4000);
        }

        // File Input Handlers
        document.addEventListener('DOMContentLoaded', function() {
            // English file input
            document.getElementById('speechThesisFileEn').addEventListener('change', function(e) {
                const fileName = this.files.length ? this.files[0].name : 'No file selected';
                document.getElementById('thesisFileNameEn').textContent = fileName;
            });

            // French file input
            document.getElementById('speechThesisFileFr').addEventListener('change', function(e) {
                const fileName = this.files.length ? this.files[0].name : 'Aucun fichier s√©lectionn√©';
                document.getElementById('thesisFileNameFr').textContent = fileName;
            });
        });

        // Speech Generation Functions
        function generateSpeechPrompt(language) {
            const suffix = language === 'english' ? 'En' : 'Fr';
            const fileInput = document.getElementById(`speechThesisFile${suffix}`);
            
            if (!fileInput.files || !fileInput.files[0]) {
                const message = language === 'english' 
                    ? 'Please select a thesis file.'
                    : 'Veuillez s√©lectionner un fichier de th√®se.';
                showStatus(`speechStatus${suffix}`, message, 'error');
                return;
            }
            
            const thesisFile = fileInput.files[0].name;
            let template = speechTemplates[language];
            const styledThesisFile = `<span class="user-input">${thesisFile}</span>`;
            
            template = template.replace('{{FILENAME}}', styledThesisFile);
            
            const outputElement = document.getElementById(`speechOutput${suffix}`);
            outputElement.innerHTML = `<div class="prompt-text">${template}</div>`;
            document.getElementById(`speechResult${suffix}`).style.display = 'block';
            
            const message = language === 'english'
                ? 'Speech prompt generated successfully!'
                : 'Invite de discours g√©n√©r√©e avec succ√®s !';
            showStatus(`speechStatus${suffix}`, message, 'success');
        }

        function copySpeechPrompt(language) {
            const suffix = language === 'english' ? 'En' : 'Fr';
            const output = document.getElementById(`speechOutput${suffix}`);
            const range = document.createRange();
            range.selectNode(output);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            document.execCommand('copy');
            window.getSelection().removeAllRanges();
            
            const message = language === 'english'
                ? 'Speech prompt copied to clipboard!'
                : 'Invite de discours copi√©e dans le presse-papiers !';
            showStatus(`speechStatus${suffix}`, message, 'success');
        }

        function resetSpeechPrompt(language) {
            const suffix = language === 'english' ? 'En' : 'Fr';
            const fileInput = document.getElementById(`speechThesisFile${suffix}`);
            
            // Reset file input
            fileInput.value = '';
            
            // Reset filename display
            const noFileText = language === 'english' ? 'No file selected' : 'Aucun fichier s√©lectionn√©';
            document.getElementById(`thesisFileName${suffix}`).textContent = noFileText;
            
            // Clear output
            document.getElementById(`speechOutput${suffix}`).innerHTML = '';
            document.getElementById(`speechResult${suffix}`).style.display = 'none';
            
            const message = language === 'english'
                ? 'Speech prompt reset successfully!'
                : 'Invite de discours r√©initialis√©e avec succ√®s !';
            showStatus(`speechStatus${suffix}`, message, 'success');
        }

        // Presentation Generation Functions
        function generatePresentationPrompt(language) {
            const suffix = language === 'english' ? 'En' : 'Fr';
            const fileInput = document.getElementById(`presentationFile${suffix}`);
            
            if (!fileInput.files.length) {
                const message = language === 'english'
                    ? 'Please select a speech file before generating the presentation prompt.'
                    : 'Veuillez s√©lectionner un fichier de discours avant de g√©n√©rer \'invite de pr√©sentation.';
                showStatus(`presentationStatus${suffix}`, message, 'error');
                return;
            }
            
            const filename = fileInput.files[0].name;
            let template = presentationTemplates[language];
            const styledFilename = `<span class="user-input">${filename}</span>`;
            
            template = template.replace('{{FILENAME}}', styledFilename);
            template = template.replace('{{NOTES}}', '');
            
            const outputElement = document.getElementById(`presentationOutput${suffix}`);
            outputElement.innerHTML = `<div class="prompt-text">${template}</div>`;
            document.getElementById(`presentationResult${suffix}`).style.display = 'block';
            
            const message = language === 'english'
                ? 'PowerPoint prompt generated successfully!'
                : 'Invite PowerPoint g√©n√©r√©e avec succ√®s !';
            showStatus(`presentationStatus${suffix}`, message, 'success');
        }

        function copyPresentationPrompt(language) {
            const suffix = language === 'english' ? 'En' : 'Fr';
            const output = document.getElementById(`presentationOutput${suffix}`);
            const range = document.createRange();
            range.selectNode(output);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            document.execCommand('copy');
            window.getSelection().removeAllRanges();
            
            const message = language === 'english'
                ? 'PowerPoint prompt copied to clipboard!'
                : 'Invite PowerPoint copi√©e dans le presse-papiers !';
            showStatus(`presentationStatus${suffix}`, message, 'success');
        }

        function resetPresentationPrompt(language) {
            const suffix = language === 'english' ? 'En' : 'Fr';
            document.getElementById(`presentationOutput${suffix}`).innerHTML = '';
            document.getElementById(`presentationResult${suffix}`).style.display = 'none';
            
            const message = language === 'english'
                ? 'PowerPoint prompt reset successfully!'
                : 'Invite PowerPoint r√©initialis√©e avec succ√®s !';
            showStatus(`presentationStatus${suffix}`, message, 'success');
        }

        // File Input Handlers
        document.addEventListener('DOMContentLoaded', function() {
            // English file input
            document.getElementById('presentationFileEn').addEventListener('change', function() {
                const statusElement = document.getElementById('presentationFileStatusEn');
                if (this.files.length > 0) {
                    statusElement.textContent = this.files[0].name;
                } else {
                    statusElement.textContent = 'No file selected';
                }
            });

            // French file input
            document.getElementById('presentationFileFr').addEventListener('change', function() {
                const statusElement = document.getElementById('presentationFileStatusFr');
                if (this.files.length > 0) {
                    statusElement.textContent = this.files[0].name;
                } else {
                    statusElement.textContent = 'Aucun fichier s√©lectionn√©';
                }
            });
        });
    </script>
</body>
</html>
